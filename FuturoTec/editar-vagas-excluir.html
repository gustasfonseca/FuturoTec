<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gestão de Vagas - Assistente Técnico</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
/* Estilos CSS (inalterados) */
* { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins', sans-serif; }
body { background-color:#f8f9fa; color:#343a40; line-height:1.6; }
a { text-decoration:none; color:inherit; }
button { cursor:pointer; }

.header { background-color:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1); padding:1rem 0; }
.nav-wrapper { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; }
.logo img { height:50px; }
.nav-desktop { display:flex; gap:1.5rem; }
.nav-link { font-weight:500; color:#343a40; padding:0.5rem 1rem; border-radius:6px; transition:all 0.3s ease; }
.nav-link:hover, .nav-link.active { background-color:#008080; color:#fff; }
.nav-actions .login-btn { display:inline-flex; align-items:center; gap:0.5rem; background-color:#008080; color:#fff; border:none; padding:0.5rem 1rem; border-radius:6px; cursor:pointer; font-weight:500; transition:background-color 0.3s ease; }
.nav-actions .login-btn:hover { background-color:#006666; }

.main-content { max-width:1200px; margin:2rem auto; padding:0 20px; }
.page-header h1 { font-size:2rem; margin-bottom:0.5rem; }
.page-header p { color:#6c757d; }

.table-card { background-color:#fff; padding:1.5rem; border-radius:8px; box-shadow:0 4px 6px rgba(0,0,0,0.05); margin-top:2rem; }
.table-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem; }
.btn-add { background-color:#008080; color:#fff; border:none; padding:0.5rem 1rem; border-radius:6px; font-weight:500; display:flex; align-items:center; gap:0.5rem; transition:background-color 0.3s ease; }
.btn-add:hover { background-color:#006666; }

table { width:100%; border-collapse:collapse; }
th, td { text-align:left; padding:0.8rem; border-bottom:1px solid #e9ecef; }
th { font-weight:600; color:#6c757d; text-transform:uppercase; font-size:0.9rem; }
tr:hover { background-color:#f1f3f5; }

.action-buttons button { border:none; background:none; font-size:1.2rem; margin-right:0.8rem; color:#343a40; transition:transform 0.2s ease; }
.action-buttons button:hover { transform:scale(1.2); color:#008080; }

/* ====== FOOTER (igual ao InicialAluno) ====== */
.footer {
  background-color:#008080;
  color:#fff;
  text-align:center;
  padding:1.5rem 0;
  font-size:0.95rem;
  font-weight:400;
  margin-top:3rem;
  box-shadow:0 -2px 5px rgba(0,0,0,0.1);
}
.footer p span {
  font-weight:600;
}

/* ====== MODAL ====== */
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:1000; }
.modal-content { background:#fff; padding:20px; border-radius:8px; width:90%; max-width:400px; display:flex; flex-direction:column; gap:10px; }
.modal-content input { padding:8px; border-radius:6px; border:1px solid #ccc; }
.modal-content button { padding:10px; border:none; border-radius:6px; background:#008080; color:#fff; font-weight:500; cursor:pointer; }
.modal-content button:hover { background:#006666; }
.modal-content .cancel-btn { background:#ccc; color:#000; }

@media(max-width:768px){ .nav-desktop { flex-direction:column; gap:0.5rem; } }
</style>
</head>
<body>

<header class="header">
  <div class="container">
    <div class="nav-wrapper">
      <div class="logo">
        <img src="img/FuturoTecInicial.jpeg" alt="FuturoTEC Logo">
      </div>
      <nav class="nav-desktop student-nav">
        <a href="InicialAssistente.html" class="nav-link">Início</a>
      </nav>
      <div class="nav-actions">
        <a href="PerfilAssistente.html" class="login-btn"><i class="fa-solid fa-user"></i> Meu Perfil</a>
      </div>
    </div>
  </div>
</header>

<main class="main-content">
  <div class="page-header">
    <h1>Gestão de Vagas</h1>
    <p>Veja, edite ou exclua as vagas publicadas.</p>
  </div>

  <div class="table-card">
    <div class="table-header">
      <h3>Vagas Publicadas</h3>
      <button class="btn-add" id="addJobBtn"><i class="fa-solid fa-plus"></i> Adicionar Vaga</button>
    </div>
    <table id="jobsTable">
      <thead>
        <tr>
          <th>Cargo</th>
          <th>Empresa</th>
          <th>Local</th>
          <th>Contato</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</main>

<footer class="footer">
    <div class="container footer-grid">
        <div class="footer-info">
            <h4>FuturoTEC</h4>
            <p>Projeto de Conclusão de Curso (TCC)</p>
            <p class="school">ETEC Albert Einstein</p>
            <p class="copyright">© 2025 FuturoTEC. Todos os direitos reservados.</p>
            <p class="authors">Desenvolvido por: Nátaly Lima, Gustavo Fonseca, Eduarda Marques, Amanda Silva, Gabrielly Mendes, Uillian Oliveira e Felipe Cardoso.</p>
        </div>

        <div class="footer-links">
            <h4>Links Úteis</h4>
            <ul>
                <li><a href="#">Termos de Uso</a></li>
                <li><a href="#">Política de Privacidade</a></li>
                <li><a href="#">Sobre nós</a></li>
                <li><a href="#">Contato</a></li>
            </ul>
        </div>

        <div class="footer-social">
            <div class="footer-logo">
            </div>
            <h4>Conecte-se</h4>
            <div class="social-icons">
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6H6a2 2 0 0 0-2 2z"></path><path d="M14 2v6h6"></path><path d="M8 12h8"></path><path d="M8 16h8"></path></svg></a>
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                <a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>
            </div>
        </div>
    </div>
    </footer>

<div class="modal" id="modal">
  <div class="modal-content">
    <input type="text" id="cargoInput" placeholder="Cargo">
    <input type="text" id="empresaInput" placeholder="Empresa">
    <input type="text" id="localInput" placeholder="Local">
    <input type="text" id="contatoInput" placeholder="Contato">
    <button type="button" id="saveBtn">Salvar</button>
    <button type="button" id="cancelBtn" class="cancel-btn">Cancelar</button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA8Q9cKB4oVmFM6ilHK_70h8JDvgsOQhLY",
  authDomain: "futurotec-e3a69.firebaseapp.com",
  projectId: "futurotec-e3a69",
  storageBucket: "futurotec-e3a69.appspot.com",
  messagingSenderId: "234233783827",
  appId: "1:234233783827:web:bf9376dee78d8924ef01e6",
  measurementId: "G-C7EEMP1146"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const vagasRef = collection(db, "vagas");

const table = document.getElementById('jobsTable').getElementsByTagName('tbody')[0];
const addBtn = document.getElementById('addJobBtn');
const modal = document.getElementById('modal');
const cargoInput = document.getElementById('cargoInput');
const empresaInput = document.getElementById('empresaInput');
const localInput = document.getElementById('localInput');
const contatoInput = document.getElementById('contatoInput');
const saveBtn = document.getElementById('saveBtn');
const cancelBtn = document.getElementById('cancelBtn');

let editId = null;

async function carregarVagas() {
  try {
    table.innerHTML = "";
    const snapshot = await getDocs(vagasRef);
    snapshot.forEach(docSnap => {
      const vaga = docSnap.data();
      const row = table.insertRow();
      row.dataset.id = docSnap.id;
      row.innerHTML = `
        <td>${vaga.cargo || 'N/A'}</td>
        <td>${vaga.empresa || 'N/A'}</td>
        <td>${vaga.local || 'N/A'}</td>
        <td>${vaga.contato || 'N/A'}</td>
        <td class="action-buttons">
          <button class="edit-btn" title="Editar"><i class="fa-solid fa-pencil"></i></button>
          <button class="delete-btn" title="Excluir"><i class="fa-solid fa-trash-can"></i></button>
        </td>
      `;
    });
  } catch (error) {
    console.error("Erro ao carregar vagas:", error);
    alert("Erro ao carregar vagas. Verifique a conexão com o Firebase.");
  }
}

addBtn.addEventListener('click', () => {
  modal.style.display = "flex";
  cargoInput.value = "";
  empresaInput.value = "";
  localInput.value = "";
  contatoInput.value = "";
  editId = null;
  saveBtn.textContent = "Salvar";
});

cancelBtn.addEventListener('click', () => modal.style.display = "none");
modal.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = "none"; });

saveBtn.addEventListener('click', async () => {
  const cargo = cargoInput.value.trim();
  const empresa = empresaInput.value.trim();
  const local = localInput.value.trim();
  const contato = contatoInput.value.trim();

  if(!cargo || !empresa || !local || !contato) { 
    alert("Preencha todos os campos!"); 
    return; 
  }

  try {
    if(editId) {
      await updateDoc(doc(db, "vagas", editId), { cargo, empresa, local, contato });
      alert("Vaga atualizada com sucesso!");
    } else {
      await addDoc(vagasRef, { cargo, empresa, local, contato });
      alert("Vaga adicionada com sucesso!");
    }
  } catch (error) {
    console.error("Erro ao salvar vaga:", error);
    alert("Falha ao salvar a vaga.");
  }

  modal.style.display = "none";
  carregarVagas();
});

table.addEventListener('click', async e => {
  const btn = e.target.closest('.edit-btn, .delete-btn');
  if(!btn) return;
  const row = btn.closest('tr');
  const id = row.dataset.id;
  const cells = row.querySelectorAll('td');

  if(btn.classList.contains('edit-btn')) {
    cargoInput.value = cells[0].textContent;
    empresaInput.value = cells[1].textContent;
    localInput.value = cells[2].textContent;
    contatoInput.value = cells[3].textContent;
    modal.style.display = "flex";
    editId = id;
    saveBtn.textContent = "Atualizar";
  }

  if(btn.classList.contains('delete-btn')) {
    if(confirm("Tem certeza que deseja excluir esta vaga?")) {
      try {
        await deleteDoc(doc(db,"vagas",id));
        carregarVagas();
      } catch (error) {
        console.error("Erro ao excluir vaga:", error);
        alert("Falha ao excluir a vaga.");
      }
    }
  }
});

carregarVagas();
</script>

</body>
</html>

